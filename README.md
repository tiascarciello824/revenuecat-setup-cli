# ğŸš€ RevenueCat Setup CLI

Automated RevenueCat project setup for React Native and Expo apps. Create projects, configure apps, set up products, and generate integration code in minutes.

## âœ¨ Features

- ğŸ” **OAuth Login** - Browser-based authentication (no API key copy-paste!)
- ğŸ¤– **Auto-Detection** - Reads `app.json` for Bundle ID and Package Name
- ğŸ“± **Auto App Creation** - Creates iOS and Android apps automatically
- ğŸ›ï¸ **Product Setup** - Configures subscriptions with trials
- ğŸ¯ **Entitlements & Offerings** - Complete offering configuration
- ğŸ“ **Code Generation** - TypeScript integration code ready to use
- ğŸ”„ **Supabase Integration** - Optional webhook and database setup
- ğŸ”‘ **API Key Auto-Write** - Updates `.env` automatically

## ğŸ¯ What It Does

1. **Auto-detects** your app configuration from `app.json`
2. **Creates RevenueCat project** (or uses existing)
3. **Creates iOS and Android apps** with your Bundle IDs
4. **Retrieves API keys** automatically from RevenueCat
5. **Writes keys to `.env`** - No manual copy-paste!
6. **Creates products**: Monthly and Annual subscriptions with 7-day trials
7. **Configures entitlements** and offerings
8. **Generates integration code**: Service layer, store, types
9. **Supabase setup** (optional): Webhook function and SQL migration

## ğŸš€ Quick Start

### Prerequisites

- Node.js 16+
- React Native or Expo project
- RevenueCat account

### Installation

```bash
# Clone the repository
git clone https://github.com/[YOUR_USERNAME]/revenuecat-setup-cli.git
cd revenuecat-setup-cli

# Install dependencies
npm install

# Build
npm run build
```

### Usage

#### Smart Mode (Recommended)

```bash
cd /path/to/your/react-native-project
node /path/to/revenuecat-setup-cli/dist/index.js --smart
```

Or create an alias:

```bash
# Add to ~/.zshrc or ~/.bashrc
alias revenuecat-setup="node /path/to/revenuecat-setup-cli/dist/index.js"

# Then use it anywhere
cd your-project
revenuecat-setup --smart
```

## ğŸ” Authentication

### OAuth Login (Recommended)

If OAuth is configured, you'll see:

```
ğŸ”‘ Autenticazione RevenueCat

? Scegli il metodo di autenticazione:
  â¯ ğŸŒ Login con browser (OAuth) - Consigliato
    ğŸ”‘ API Key manuale
```

Select OAuth to:
1. Open browser automatically
2. Login to RevenueCat
3. Authorize the app
4. âœ¨ Done! No copying API keys

### API Key (Fallback)

If OAuth is not available, you'll be prompted for your RevenueCat Secret API Key:
- Find it in RevenueCat Dashboard â†’ Settings â†’ API Keys
- Use the **Secret Key** (starts with `sk_`)

## ğŸ“‹ What You'll Get

### Generated Files

```
your-project/
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ revenuecat.ts          # RevenueCat service layer
â”‚   â””â”€â”€ supabase/
â”‚       â””â”€â”€ subscriptions.sql       # Database migration
â”œâ”€â”€ store/
â”‚   â””â”€â”€ subscriptionStore.ts        # Zustand subscription store
â”œâ”€â”€ types/
â”‚   â””â”€â”€ subscription.ts             # TypeScript types
â”œâ”€â”€ supabase/
â”‚   â””â”€â”€ functions/
â”‚       â””â”€â”€ handle-revenuecat-webhook/
â”‚           â””â”€â”€ index.ts            # Webhook handler
â””â”€â”€ .env                            # Updated with API keys âœ¨
```

### Updated .env

```bash
# Auto-generated by the CLI
EXPO_PUBLIC_REVENUECAT_IOS_KEY=appl_xxxxxxxxxxxxx
EXPO_PUBLIC_REVENUECAT_ANDROID_KEY=goog_xxxxxxxxxxxxx
```

## ğŸ¬ Demo Flow

```bash
$ revenuecat-setup --smart

ğŸš€ RevenueCat Setup - Smart Mode
â„¹ Rilevamento automatico della configurazione...

ğŸ“± Configurazione Rilevata
â„¹ Nome App: MyAwesomeApp
â„¹ Bundle ID iOS: com.company.app
â„¹ Package Name Android: com.company.app
â„¹ Platform: expo
â„¹ Backend: supabase

ğŸ”‘ Autenticazione RevenueCat
? Scegli il metodo di autenticazione: ğŸŒ Login con browser

ğŸ”“ OAuth callback server started
âœ“ Browser opened. Please authorize the application.
âœ“ Authorization successful!

ğŸ—ï¸  RevenueCat Project
âœ“ Progetto creato: MyAwesomeApp

ğŸ“± Creazione App
âœ“ App iOS creata
âœ“ App Android creata
âœ“ Chiavi API recuperate

âš™ï¸  Creazione in RevenueCat
âœ“ Creati 2 prodotti
âœ“ Creati 1 entitlement(s)
âœ“ Creati 1 offering(s)

ğŸ”‘ Aggiornamento .env
âœ“ Chiavi aggiunte al file .env

ğŸ“ Generazione Codice
âœ“ Generati 7 file(s)

âœ… Setup Completato!
```

## ğŸ› ï¸ Configuration

### Environment Variables

```bash
# OAuth Client ID (optional, for OAuth flow)
export REVENUECAT_OAUTH_CLIENT_ID="your_client_id"

# API Key (for API key auth)
export REVENUECAT_API_KEY="sk_xxxxxxxxxxxxx"
```

### Auto-Detection

The CLI automatically detects from `app.json`:
- App name
- iOS Bundle ID (`expo.ios.bundleIdentifier`)
- Android Package Name (`expo.android.package`)
- Platform (Expo vs React Native)
- Backend (Supabase, Firebase, etc.)

## ğŸ“¦ Products Created

By default, creates:

- **Monthly Subscription**
  - ID: `{app}_pro_monthly`
  - Trial: 7 days
  - Type: Subscription

- **Annual Subscription**
  - ID: `{app}_pro_annual`
  - Trial: 7 days
  - Type: Subscription

- **Entitlement**: `pro` (includes both products)
- **Offering**: `default` (current, with both packages)

## ğŸ”§ Advanced Usage

### Interactive Mode

```bash
revenuecat-setup --interactive
```

Customize every detail:
- Product IDs and pricing
- Trial periods
- Entitlement names
- Offering configuration

### Auto Mode

```bash
revenuecat-setup --auto
```

Zero prompts - uses all defaults.

## ğŸ¤ Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## ğŸ“„ License

MIT

## ğŸ†˜ Support

- [RevenueCat Documentation](https://www.revenuecat.com/docs)
- [OAuth Setup Guide](./OAUTH_SETUP.md)
- [Issues](https://github.com/[YOUR_USERNAME]/revenuecat-setup-cli/issues)

## âš™ï¸ OAuth Setup

To enable OAuth authentication:

1. Contact support@revenuecat.com to register an OAuth client
2. Set the `REVENUECAT_OAUTH_CLIENT_ID` environment variable
3. See [OAUTH_SETUP.md](./OAUTH_SETUP.md) for details

## ğŸ‰ Credits

Built with â¤ï¸ for the React Native and Expo community.

---

**Made by**: [Your Name]  
**Powered by**: [RevenueCat](https://www.revenuecat.com)
